#!/bin/bash

./start-l1-geth-killable.sh &
./start-l2-geth-killable.sh &
echo "sleep 10 sec while nodes boot up"
sleep 10
./start-rollup-node-killable.sh &

export ETH_RPC_URL=http://localhost:8545
DEPOSIT_CONTRACT=0xdeaddeaddeaddeaddeaddeaddeaddeaddead0001
DEV_ADDR=0x30eC912c5b1D14aa6d1cb9AA7A6682415C4F7Eb0
DEPOSIT_SIG='depositTransaction(address,uint256,uint256,bool,bytes)'

echo $(grep "mnemonic:" rollup.yaml | cut -c12- | rev | cut -c2- | rev ) > .mnemonic

cast send --mnemonic-path .mnemonic --from $DEV_ADDR $DEPOSIT_CONTRACT "$DEPOSIT_SIG" 0xABBAABBAABBAABBAABBAABBAABBAABBAABBAABBA 1000 1000000 false 0x00000000000000000000000011111111111111111111111111111111111111110000000000000000000000001111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000140000000000000000000000000000000000000000000000000000000000000000

# alternatively:
# seth send -V 1000 $CONTRACT_ADDRESS 'depositTransaction(address,uint256,uint256,bool,bytes)' 0xABBAABBAABBAABBAABBAABBAABBAABBAABBAABBA 1000 1000000 false 0x00000000000000000000000011111111111111111111111111111111111111110000000000000000000000001111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000140000000000000000000000000000000000000000000000000000000000000000 -F $SENDER_ADDRESS
